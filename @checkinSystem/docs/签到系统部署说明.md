# 劳务签到系统部署说明

## 概述
本文档说明如何将劳务签到系统部署到远程服务器 `http://118.196.16.32:3000`。

## 前提条件
1. 远程服务器已启动并运行低代码Excel数据管理系统
2. 网络连接正常，可以访问 `http://118.196.16.32:3000`
3. 本地环境已安装 Node.js 和 npm

## 部署步骤

### 1. 测试服务器连接
```bash
# 测试服务器健康状态
curl http://118.196.16.32:3000/health

# 如果连接失败，请检查：
# - 服务器是否正在运行
# - 网络连接是否正常
# - 防火墙设置
```

### 2. 执行部署脚本
```bash
# 进入项目目录
cd /Users/chenzhihan/Desktop/lowCode_excel

# 执行远程部署脚本
node 远程签到系统部署脚本.js
```

### 3. 部署过程说明
部署脚本将执行以下步骤：
1. **检查服务器连接** - 验证远程服务器是否可访问
2. **创建签到表单** - 在服务器上创建劳务签到表单定义
3. **配置Hook** - 设置自动时间记录和工作时间计算Hook
4. **验证系统** - 检查部署结果和功能完整性

### 4. 前端增强脚本使用
部署完成后，需要在签到表单页面加载前端增强脚本：

```html
<!-- 在签到表单页面中添加以下脚本 -->
<script src="签到系统增强脚本.js"></script>
```

或者通过浏览器开发者工具的控制台加载：
```javascript
// 复制并执行签到系统增强脚本.js的内容
```

## 脚本文件说明

### 1. 远程签到系统部署脚本.js
- **功能**: 自动部署签到系统到远程服务器
- **特点**: 包含重试机制、错误处理和详细日志
- **配置**: 目标服务器地址、超时设置等

### 2. 签到系统增强脚本.js
- **功能**: 前端增强，添加签到/签退按钮和自动时间记录
- **特点**: 基于表哈希值自动识别签到表单
- **兼容性**: 支持现有表单系统

### 3. 配置签到表字段.js
- **功能**: 定义签到表的字段结构和验证规则
- **用途**: 用于手动配置表结构时的参考

## 系统功能

### 核心功能
- ✅ 自动签到时间记录
- ✅ 自动签退时间记录  
- ✅ 工作时间自动计算
- ✅ 表单验证（姓名、手机号、公司选择）
- ✅ 重复签到检查

### 表单字段
- **姓名** (必填)
- **手机号** (必填，格式验证)
- **所在公司** (必填，下拉选项)
- **签到时间** (自动记录)
- **签退时间** (自动记录)
- **实际工作时间** (自动计算)

### 公司选项
- 汇博劳务公司
- 恒信劳务公司
- 临时工

## 访问地址

### 公开表单地址
```
http://118.196.16.32:3000/api/public/form/labor_sign_in
```

### 数据查询地址
```
http://118.196.16.32:3000/browser?hash=a7b672aabd61efd9f39668fc4fa179fc
```

## 故障排除

### 常见问题

#### 1. 服务器连接失败
```bash
# 检查网络连接
ping 118.196.16.32

# 检查端口是否开放
telnet 118.196.16.32 3000
```

#### 2. 部署脚本执行失败
- 检查 Node.js 版本: `node --version`
- 安装依赖: `npm install axios`
- 检查网络代理设置

#### 3. 前端脚本不生效
- 确认表哈希值正确: `a7b672aabd61efd9f39668fc4fa179fc`
- 检查浏览器控制台错误信息
- 确认脚本在表单页面加载

#### 4. Hook功能异常
- 检查服务器日志
- 验证Hook配置是否正确创建
- 测试表单提交功能

### 日志检查
```bash
# 查看服务器日志（如果可访问）
tail -f /path/to/server/logs

# 浏览器开发者工具查看前端日志
# 打开 Console 标签查看脚本输出
```

## 维护说明

### 定期检查
- 监控服务器健康状态
- 检查签到数据完整性
- 验证工作时间计算准确性

### 数据备份
- 定期备份签到记录数据
- 导出Excel格式的签到报表

### 系统升级
- 更新前端增强脚本时需重新加载
- 修改Hook配置需重新部署
- 添加新字段需更新表单定义

## 技术支持
如遇问题，请检查：
1. 服务器连接状态
2. 部署脚本执行日志
3. 浏览器控制台错误信息
4. 服务器应用日志

---
*最后更新: 2025-11-17*
