<!--
 * @Date: 2025-10-08 23:38:16
 * @LastEditors: CZH
 * @LastEditTime: 2025-10-22 15:50:44
 * @FilePath: /lowCode_excel/新功能使用说明.md
-->
# Excel文件上传 - 指定表头行功能使用说明

## 功能概述

本功能允许用户在上传Excel文件时，可以指定任意一行作为表头行，从而更灵活地处理不同格式的Excel文件。

## 主要特性

1. **数据预览** - 上传前可预览Excel文件的所有数据
2. **动态表头选择** - 点击任意行即可将其设置为表头
3. **实时表结构预览** - 选择不同表头行时，实时显示对应的表结构
4. **数据预览** - 显示基于当前表头行的前5行数据预览

## 使用流程

### 1. 上传文件
- 点击"上传文件"按钮
- 选择Excel文件（.xlsx或.xls格式）
- 点击"预览并上传"

### 2. 预览数据
- 系统显示Excel文件的所有数据
- 默认选择第一行作为表头
- 可以点击任意行将其设置为表头

### 3. 选择表头行
- 点击表格中的任意行
- 系统会立即重新解析数据，显示新的表结构
- 表结构预览包括：
  - 字段名（基于选择的表头行）
  - 数据类型（自动推断）
  - 数据预览（前5行）

### 4. 确认上传
- 确认表结构正确后，点击"确认上传"
- 系统将根据选择的表头行创建数据表
- 上传成功后返回文件管理页面

## 技术特点

### 前端功能
- **渐进式解析**：只在用户选择表头行时才进行详细解析，避免性能浪费
- **实时响应**：表头行切换时立即更新表结构预览
- **状态管理**：清晰显示解析状态和当前选择

### 后端API
- **动态解析接口**：`POST /api/upload/dynamic-parse`
- **支持参数**：文件 + 表头行号
- **返回结果**：表结构信息 + 数据预览

## 注意事项

1. **文件大小**：建议文件大小不超过10MB
2. **表头行选择**：确保选择的表头行包含有效的字段名
3. **数据类型**：系统会自动推断数据类型，但可能需要手动调整
4. **性能考虑**：大文件切换表头行时可能需要等待解析完成

## 故障排除

### 表结构预览不更新
- 检查浏览器控制台是否有错误信息
- 确认后端服务器正常运行
- 检查网络连接是否正常

### 解析失败
- 确认Excel文件格式正确
- 检查文件是否损坏
- 尝试重新上传文件

## 更新日志

- **2025-10-22**：新增动态表头行选择功能
- **2025-10-22**：新增实时表结构预览功能
- **2025-10-22**：优化用户体验，添加加载状态提示
